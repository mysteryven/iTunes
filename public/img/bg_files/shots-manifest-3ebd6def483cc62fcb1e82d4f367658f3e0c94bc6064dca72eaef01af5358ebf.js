Dribbble.throttle=function(n,o,s){var r,a;return s=s||this,function(){var e=+new Date,t=arguments,i=function(){a=e,n.apply(s,t)};a&&e<a+o?r||(r=setTimeout(function(){i(),r=null},e-a+o)):i()}},Dribbble.debounce=function(t,i,n){var o;return n=n||this,function(){clearTimeout(o);var e=arguments;o=setTimeout(function(){t.apply(n,e)},i)}},window.requestAnimationFrame?Dribbble.requestAnimationFrameWithLeadingCall=function(t,i){var n=!1;return function(){var e=arguments;if(!n)return n=!0,t.apply(i,e);window.requestAnimationFrame(function(){t.apply(i,e)})}}:Dribbble.requestAnimationFrameWithLeadingCall=function(e,t){return Dribbble.throttle(e,16,t)},Dribbble.requestAnimationFrame=function(e,t){var i=function(){e.apply(t)};window.requestAnimationFrame?window.requestAnimationFrame(i):setTimeout(i)},Dribbble.InfiniteScroll={paginationContainerHTML:'<div class="loading-more"><span class="processing">Loading more\u2026</span></div>',genericLoadingIndicator:function(){return{retry:function(e){this.reset(),e.disabledNext=!1,e.fetchNextPage()},hide:$.noop,reset:$.noop,show:$.noop,showErrorEncountered:$.noop,showReachedEnd:$.noop,showThrottled:$.noop}},jqueryLoadingIndicator:function(e){var i=$(e),t=function(e){i.html('<span class="null-message">'+e+"</span>").show()};return $.extend({},new Dribbble.InfiniteScroll.genericLoadingIndicator,{$el:i,selector:e,originalContent:i.html(),show:function(){i.show()},hide:function(){i.hide()},reset:function(){i.html(this.originalContent)},showCustomEnd:function(e){i.html(e)},showReachedEnd:function(){t("You\u2019ve reached the end of the list")},showErrorEncountered:function(){t("Something went wrong\u2026")},showThrottled:function(t){i.html('<div class="rate-limited"><a href="#" class="load-next-page">Load more\u2026</a> <span>You\u2019ve exceeded our rate limits, so you may need to wait a minute or so. <a href="https://help.dribbble.com/#rate-limits" target="_blank">(more info)</a><span></div>'),i.find("a.load-next-page").on("click",function(e){e.preventDefault(),this.retry(t)}.bind(this))}})},horizontalScrollingIndicator:function(e){return $.extend({},new Dribbble.InfiniteScroll.genericLoadingIndicator,{show:function(){e.append("<div class='processing' />")},hide:function(){e.find(".processing").remove()},showReachedEnd:function(){this.hide()},showErrorEncountered:function(){this.hide()},reset:function(){e.find(".rate-limited").remove(),this.hide()},showThrottled:function(t){this.hide(),e.append('<li class="rate-limited"><a href="#" class="load-next-page">Load more\u2026</a> <span>You\u2019ve exceeded our rate limits, so you may need to wait a minute or so. <a href="https://help.dribbble.com/#rate-limits" target="_blank">(more info)</a><span></li>'),e.find(".load-next-page").on("click",function(e){e.preventDefault(),this.retry(t)}.bind(this))}})}},Dribbble.InfiniteScroll.Generic=function(e){this.initialize(e)},Dribbble.InfiniteScroll.Generic.prototype={$el:null,scrollable:null,itemSelector:null,perPage:null,buffer:null,baseUrl:document.location.toString(),autoLoadPageLimit:null,autofill:!0,disabledNext:!1,loading:!1,reachedEnd:!1,throttleTime:25,lastPosition:0,loadingIndicator:null,unique:!1,initialize:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);this.scrollable=this.scrollable||this.$el,this.isScrolling=Dribbble.throttle(this.isScrolling,this.throttleTime,this),this.loadingIndicator=this.loadingIndicator||new Dribbble.InfiniteScroll.jqueryLoadingIndicator(this.loadingIndicatorSelector),this.setPage(),this.bindEventListeners()},reset:function(e){this.baseUrl=e||this.baseUrl,this.currentXhr&&this.currentXhr.abort(),this.reachedEnd=!1,this.disabledNext=!1,this.$el.empty(),this.loaded=0,this.resetPage(),this.setLoading(!1),this.fetchNextPage(function(){Dribbble.LargeShotViewRecorder&&Dribbble.LargeShotViewRecorder.start()})},bindEventListeners:function(){$(window).on("unload",this.onUnload.bind(this)).ready(this.onReady.bind(this))},onUnload:function(){$(window).scrollTop(0)},onReady:function(){return this.unique&&$(this.scrollable).off("scroll.infinite"),$(this.scrollable).on("scroll.infinite",this.isScrolling.bind(this)),this.deferredContentLoader?this.deferredContentLoader():this.noMoreItemsToLoad(this.$el.find(this.itemSelector))?(this.reachedEnd=!0,void this.setLoading(!1)):(this.disabledNext=!1,void(this.autofill&&this.fetchNextPageIfNeeded()))},isScrolling:function(){var e=this.scrollPosition();if(this.$el.toggleClass("is-scrolled",0<e),this.internalOnScroll&&this.internalOnScroll(e),!this.reachedEnd){this.onScroll&&this.onScroll.apply(this,[e]);var t=e>this.lastPosition;this.lastPosition=e,this.loading||t&&this.fetchNextPageIfNeeded(e)}},fetchNextPageIfNeeded:function(e){this.disabledNext||this.noLongerInDom()||this.distanceToEnd(e)>this.buffer||this.fetchNextPage()},fetchNextPage:function(e){if(!this.loading)return this.setLoading(!0),this.fetchPage(this.page.last+1,e),!1},fetchPage:function(e,t){var i=this.urlForPage(e);this.onFetchPage&&this.onFetchPage(e,i);var n=function(e){202==this.currentXhr.status?(this.delay=(this.delay||0)+150,setTimeout(function(){this.fetchPage()}.bind(this),this.delay)):(this.showNextPage(e),t&&t())}.bind(this);this.currentXhr=$.ajax(i,{context:this,success:n,error:this.showError})},append:function(e){this.$el.append(e)},noMoreItemsToLoad:function(e){return e.length<this.perPage},noLongerInDom:function(){var e=$(this.scrollable)[0];return e!=window&&!$.contains(document.documentElement,e)},showNextPage:function(e){var t;if(this.jsonItems?(t=this.jsonItems(e),this.append(e)):(t=$(e).filter(this.itemSelector),t=this.onBeforeAppend?this.onBeforeAppend(t):t,this.append(t),$("body").append($(e).filter("script")),Dribbble.MediaSwap&&new Dribbble.MediaSwap("[data-video-teaser-small][data-video-teaser-large]")),this.loaded+=t.length,this.page.last++,this.onAfterAppend&&this.onAfterAppend(t),this.setLoading(!1),this.noMoreItemsToLoad(t))return this.disabledNext=!0,this.reachedEnd=!0,this.loadingIndicator.showReachedEnd(),void $(this.loadNextButtonSelector).hide();this.autoLoadPageLimit&&this.page.last%this.autoLoadPageLimit==0?(this.disabledNext=!0,$(this.loadNextButtonSelector).show(),this.nextButtonCanLoadMore&&!this.nextButtonCanLoadMore()&&(this.reachedEnd=!0)):this.autofill&&this.fetchNextPageIfNeeded()},setLoading:function(e){(this.loading=e)&&$(this.loadNextButtonSelector).hide(),this.loadingIndicator[e?"show":"hide"]()},resetPage:function(){this.setPage(0)},setPage:function(e){e=void 0!==e?e:1;var t=this.baseUrl.match(/page=(\d+)/);t&&(e=parseInt(t[1],10)),this.page={first:e,last:e}},showError:function(e){if("abort"!=(e=e||{}).statusText){if(403==e.status)return this.loading=!1,void this.loadingIndicator.showThrottled(this);404==e.status?this.loadingIndicator.showReachedEnd():401==e.status?this.loadingIndicator.showCustomEnd(e.responseText):this.loadingIndicator.showErrorEncountered(e),this.disabledNext=!0,this.reachedEnd=!0,$(this.loadNextButtonSelector).hide()}},queryParamsForPage:function(e){return{page:e,per_page:this.perPage}},urlForPage:function(e){var t=this.queryParamsForPage(e),i=this.baseUrl.split("#")[0];return-1<i.indexOf("?")?i+"&"+$.param(t):i+"?"+$.param(t)}},Dribbble.InfiniteScroll.Vertical=function(e){this.initialize(e)},Dribbble.InfiniteScroll.Vertical.prototype=$.extend({},Dribbble.InfiniteScroll.Generic.prototype,{buffer:window.innerHeight,scrollable:window,bindEventListeners:function(){Dribbble.InfiniteScroll.Generic.prototype.bindEventListeners.apply(this),this.$backToTop&&this.$backToTop.on("click",function(){$("html,body").animate({scrollTop:0,display:"none"},500)})},distanceToEnd:function(e){return this.$el.height()-$(this.scrollable).height()-(e||this.scrollPosition())},internalOnScroll:function(e){this.$backToTop&&!Dribbble.isMobile()&&(50<e?this.$backToTop.fadeIn(100):this.$backToTop.fadeOut(100))},scrollPosition:function(){return $(this.scrollable).scrollTop()}}),Dribbble.InfiniteScroll.Horizontal=function(e){this.initialize(e)},Dribbble.InfiniteScroll.Horizontal.prototype=$.extend({},Dribbble.InfiniteScroll.Generic.prototype,{initialize:function(e){Dribbble.InfiniteScroll.Generic.prototype.initialize.apply(this,[e]),this.buffer=.75*this.$el.width(),$(this.scrollable).on("click",".scroll-backward a",this.scrollBackward.bind(this)),$(this.scrollable).on("click",".scroll-forward a",this.scrollForward.bind(this))},distanceToEnd:function(e){var t=(e||this.scrollPosition())+$(this.scrollable).width();return this.$el[0].scrollWidth-t},scrollPosition:function(){return $(this.scrollable).scrollLeft()},scrollBackward:function(e){this.scrollInDirection(e,-1)},scrollForward:function(e){this.scrollInDirection(e,1)},scrollInDirection:function(e,t){e.preventDefault();var i=80;$(this.scrollable).animate({scrollLeft:this.scrollPosition()+($(this.scrollable).width()-i)*t},800)}}),Dribbble.InfiniteScroll.Vertical.Simple=function(e){this.initialize(e)},Dribbble.InfiniteScroll.Vertical.Simple.prototype=$.extend({},Dribbble.InfiniteScroll.Vertical.prototype,{initialize:function(e){$(e.paginationContainerSelector||"div.page").find(".pagination").hide(),$(Dribbble.InfiniteScroll.paginationContainerHTML).insertAfter(e.$el);var t=$.extend({},e,{loadingIndicatorSelector:".loading-more",$backToTop:e.$backToTop||$("div.back-to-top")});Dribbble.InfiniteScroll.Vertical.prototype.initialize.apply(this,[t])}}),Dribbble.ShotOverlay={$el:null,active:!1,infiniteScroller:null,originalUrl:null,shotClickTargetSelector:null,shotElSelector:null,currentShotId:null,$overlayContent:$(".overlay-content"),$shotOverlay:$(".shot-overlay"),$currentShotEl:function(){return this.$el.find("#screenshot-"+this.currentShotId).last()},$next:function(){return this.$currentShotEl().nextAll(this.shotElSelector).first()},$prev:function(){return this.$currentShotEl().prevAll(this.shotElSelector).first()},handleNonGetMethods:function(e){var t=$(e.target);return $.rails.allowAction(t)&&$.rails.handleMethod(t),!1},init:function(e){e=e||{},this.setInfiniteScroller(e.infiniteScroller),this.originalUrl=e.originalUrl,this.shotClickTargetSelector=e.shotClickTargetSelector,this.shotElSelector=e.shotElSelector,this.onTrigger=e.onTrigger||$.noop,this.bindEventListeners(),this.active=!0},setInfiniteScroller:function(e){this.infiniteScroller=e,this.infiniteScroller?(this.$el=this.infiniteScroller.$el,this.infiniteScroller.onAfterAppend=this.addShotsToList.bind(this)):this.$el=null},bindEventListeners:function(){this.$mobileHiddenElements=$("#wrap, #header, #footer");var t=function(e){return e.shiftKey||e.ctrlKey||e.metaKey};$(document.body).on("click",this.shotClickTargetSelector,function(e){if(this.onTrigger&&this.onTrigger(e),!t(e))return this.open($(e.currentTarget)),!1}.bind(this)),$(document.body).on("click",".rebound-title a, .more-thumbs li a",function(e){if(!t(e))return this.open($(e.currentTarget),!0),!1}.bind(this)),$(document.body).on("click","div.shot-overlay, a.close-overlay",function(){return this.close(),!1}.bind(this)),$(document.body).on("click","div.shot-overlay div.overlay-content",function(e){e.stopPropagation()}),Dribbble.Hotkeys.map("screenshots",{ESCAPE:function(){this.isOpen()&&this.close()}.bind(this)},function(){return!Dribbble.Attachments.overlayVisible()&&!Dribbble.Overlay.anyOpen()})},open:function(e,t){var i=e.attr("href");Dribbble.Router.pushState({"steps-from-list":this.stepsToListPage()+1,"disable-nav":!!t},null,i)},close:function(){this.stepsToListPage()>window.history.length?Dribbble.Router.pushState(null,null,this.originalUrl):Dribbble.Router.go(-this.stepsToListPage())},show:function(e){this.infiniteScroller.autofill=!1,this.currentShotId=e.match(/shots\/(\d+)/)[1],this.$overlayContent.html(this.loadingTemplate),this.$shotOverlay.add(this.$overlayContent).addClass("overlay-visible").trigger("focus"),$(".tipsy").remove(),Dribbble.HoverCards&&Dribbble.HoverCards.dismiss(),$.ajax(e,{dataType:"html",context:this,cache:!1,success:function(e){if(this.$overlayContent.html(e),this.$overlayContent.find(".main-shot").removeClass("full-800"),this.$overlayContent.find($.rails.linkClickSelector).on("click",this.handleNonGetMethods),Dribbble.isMobile()?(this.$overlayContent.find("[rel=tipsy]").attr("original-title",""),this.lastScrollPosition=window.pageYOffset,window.scrollTo(0,0),this.$mobileHiddenElements.hide()):document.body.classList.add("noscroll"),User.loggedOut()&&Dribbble.SignupModal.overlay.bindTrigger(),Dribbble.Hotkeys.TextAreaSubmission.fillShortcuts(),this.shouldShowNav()){var t=this.$prev(),i=this.$next();i[0]||this.infiniteScroller.reachedEnd||(this.infiniteScroller.disabledNext=!1,this.infiniteScroller.fetchNextPage()),t[0]&&this.showPrevButton(t),i[0]&&this.showNextButton(i)}}})},hide:function(){this.infiniteScroller.autofill=!0,this.$mobileHiddenElements.show(),document.body.classList.remove("noscroll"),Dribbble.isMobile()&&window.scrollTo(this.lastScrollPosition,0),this.$shotOverlay.add(this.$overlayContent).scrollTop(0).removeClass("overlay-visible"),setTimeout(function(){this.$overlayContent.html("")}.bind(this),100)},shouldShowNav:function(){return!History.getState().data["disable-nav"]},stepsToListPage:function(){return History.getState().data["steps-from-list"]||0},showNextButton:function(e){e[0]&&this.$overlayContent.find(".shot-nav-next").on("click",function(){this.reviewForSignup($(".shot-nav-next a"),e)}.bind(this)).show()},showPrevButton:function(e){this.$overlayContent.find(".shot-nav-prev").on("click",function(){this.reviewForSignup($(".shot-nav-prev a"),e)}.bind(this)).show()},reviewForSignup:function(e,t){var i=e.data("signup-trigger");this.setNavLink(e,i,t)},setNavLink:function(e,t,i){return t?(this.close(),this.open(e)):(this.open(this.findSiblingLink(i)),!1)},findSiblingLink:function(e){return e.attr("href")?e:e.find("a.dribbble-over")},addShotsToList:function(e){e.length&&this.showNextButton(this.$next())},isOpen:function(){return this.$shotOverlay.is(":visible")},loadingTemplate:function(){var e=$('<div class="shot-loading-header" />').append([$('<div class="shot-loading avatar" />'),$('<div class="shot-loading title" />')]),t=$('<div class="shot-loading-main" />').append($('<div class="shot-loading shot" />')),i=$('<div class="shot-loading-left" />').append($('<div class="shot-loading description" />')),n=$('<div class="shot-loading-right" />').append($('<div class="shot-loading description" />')),o=$('<div class="shot-loading-columns" />').append(i,n);return $('<div class="shot-loading-container" />').append(e,t,o)}()},Dribbble.Screenshots={AUTOMATIC_LIMIT:4,DEFAULT_PER_PAGE:24,originalUrl:document.location.toString(),initialize:function(e){Dribbble.isHistorySupported()&&$(".dribbbles")[0]&&(this.findElements(),this.infiniteScroller=new Dribbble.InfiniteScroll.Vertical(this.scrollerOptions(e)),e.enable_overlay&&Dribbble.ShotOverlay.init({infiniteScroller:this.infiniteScroller,originalUrl:this.originalUrl,shotClickTargetSelector:".dribbbles:not(.selectable) a.dribbble-link, .dribbbles:not(.selectable) a.dribbble-over, .dribbbles:not(.selectable) a.animated-target",shotElSelector:"li.group"}),Dribbble.AnimatedGifSwap&&Dribbble.AnimatedGifSwap.attach(".gif > .animated-target",{parentSelector:"li.group:first",picSelector:".dribbble-shot picture"}),Dribbble.MediaSwap&&new Dribbble.MediaSwap("[data-video-teaser-small][data-video-teaser-large]"),this.bindEventListeners())},bindEventListeners:function(){this.loadNextButton.find(".load-more").on("click",function(){this.infiniteScroller.disabledNext=!1,this.infiniteScroller.fetchNextPage(),this.shuffleAd()}.bind(this))},onFetchPage:function(e,t){Dribbble.Analytics.logDribbbleGAPageView(t),Dribbble.Segment.page({url:t})},findElements:function(){var e=$("#main");this.list=e.find("ol.dribbbles"),this.loadNextButton=e.find(".infinite:not(.previous)"),this.footer=$(".secondary"),this.footer.is(":visible")||(this.footer=$("#footer")),e.find(".page").remove()},shuffleAd:function(){Dribbble.Ads.shuffle()},refreshList:function(e){this.infiniteScroller.reset(e)},scrollerOptions:function(e){var t={$el:this.list,itemSelector:"li.group",loadNextButtonSelector:".infinite:not(.previous)",loadingIndicatorSelector:".loading-more:not(.previous)",perPage:this.DEFAULT_PER_PAGE,autoLoadPageLimit:e.page_limit||this.AUTOMATIC_LIMIT,onFetchPage:this.onFetchPage.bind(this),buffer:window.innerHeight-this.footer.height(),$backToTop:$("div.back-to-top"),unique:!0,nextButtonCanLoadMore:function(){return 0===$(".sign-up-to-continue").length},append:function(e){var t=this.$el.find(this.itemSelector).map(function(){return this.id});e=$.grep(e,function(e){return-1==$.inArray(e.id,t)}),this.$el.append(e)}};return e.deferredContent&&(t=$.extend(t,{deferredContentLoader:this.refreshList.bind(this),queryParamsForPage:function(){return{cursor:Dribbble.Screenshots.cursor,per_page:this.perPage,page:this.page.last+1}},resetPage:function(){Dribbble.Screenshots.cursor=null,this.setPage(0)}})),e.cursor&&(t=$.extend(t,{noMoreItemsToLoad:function(){return Dribbble.Screenshots.noMoreItemsToLoad},queryParamsForPage:function(){return{cursor:Dribbble.Screenshots.cursor,per_page:this.perPage,page:this.page.last+1,sig:Dribbble.Screenshots.signature}},resetPage:function(){Dribbble.Screenshots.cursor=null,this.setPage(0)}})),t}};var Screenshot={Like:{Shot:{toggle:function(){if(0!=$(".logged-in").length){if(0==$("a[data-fav-toggle=shot].processing").length){var t=$("a[data-fav-toggle=shot]"),e=t.attr("href"),i=!t.hasClass("current-user-likes"),n=i?{}:{_method:"delete"},o=$("[data-screenshot_id]").data().screenshot_id;$.ajax({type:"POST",url:e,data:n,beforeSend:function(){t.addClass("processing"),t.find("span.stats-label").text("Wait\u2026")},success:function(e){t.parent("li").replaceWith(e),Dribbble.Shots.logAnalyticsLike(o,{action:i?"like":"unlike"})}})}return!1}}},Comment:{toggle:function(){var n=$(this),e=n.hasClass("liked-by-current-user")?{_method:"delete"}:null;return $.ajax({type:"POST",url:this.href,data:e,success:function(e){var t=$(e),i=n.closest(".comment");i.find(".reply").length&&Dribbble.Comments.ReplyLinks.add(t),i.replaceWith(t)}}),!1}}},Flag:{showFlag:function(){return $(".flag-confirm").slideDown(),!1},flag:function(){var e=$(this).attr("action"),t=$(this).find("input#screenshot_id").val(),i=$("#flag_note").val();return confirm("You are about to report this shot as abuse of Dribbble. Are you sure you wish to continue?")&&$.ajax({type:"POST",url:e,data:{screenshot_id:t,note:i},success:function(e){$("#flag-section").html(e)}}),!1},unflag:function(){var e=$(this).modelId();return $.ajax({type:"POST",url:this.href,data:{_method:"delete",screenshot_id:e},success:function(e){$("#flag-section").html(e)}}),!1}},Page:{next:function(){return $(".shot-nav-next a").trigger("click"),!0},prev:function(){return $(".shot-nav-prev a").trigger("click"),!0}},Shot:{twotimes:function(){if(window.matchMedia("screen and (max-width: "+DEVICE_WIDTH_BREAKPOINT+")").matches)return!1;var e=$(".main-shot"),t="full-800",i=window.matchMedia(HIDPI_BREAKPOINT).matches,n=$(".the-shot .single-img");if(e.hasClass(t))e.removeClass(t),!i&&n.find("picture").length&&(n.find("img").attr("src",n.find("img").attr("data-oldsrc")),n.find("source:not([media])").attr("srcset",n.find("source:not([media])").attr("data-oldsrc")));else if(e.addClass(t),!i&&n.find("picture").length){var o=n.find("source[media]").attr("srcset"),s=n.find("img");s.attr("data-oldsrc",s.attr("src")),s.attr("src",o);var r=n.find("source:not([media])");r.attr("data-oldsrc",r.attr("srcset")),r.attr("srcset",o)}}},Bucket:{open:function(){$("a[data-bucket-add]").trigger("click")}}},newLocation;$(document.body).on("click",".admin a.flag",Screenshot.Flag.showFlag),$(document.body).on("click",".admin a.unflag",Screenshot.Flag.unflag),$(document.body).on("submit",".admin form.flag-confirm",Screenshot.Flag.flag),$(document.body).on("click","a[data-fav-toggle=shot]",Screenshot.Like.Shot.toggle),Dribbble.Hotkeys.map("screenshot",{B:Screenshot.Bucket.open,F:Screenshot.Like.Shot.toggle,L:Screenshot.Like.Shot.toggle,LEFT:Screenshot.Page.prev,RIGHT:Screenshot.Page.next},function(){return!Dribbble.Attachments.overlayVisible()&&!Dribbble.Overlay.anyOpen()}),$(document.body).on("click",".comment a.likes",Screenshot.Like.Comment.toggle);var shorterTotal=function(e){return 1e6<=e?e=(e/1e6).toFixed(2)+"M":1e3<=e&&(e=(e/1e3).toFixed(1)+"k"),e};!function(o){o.fn.charCount=function(n){function e(e){var t=o(e).val().length,i=n.allowed-t;i<=n.warning&&0<=i?o(e).next().addClass(n.cssWarning):o(e).next().removeClass(n.cssWarning),i<0?o(e).next().addClass(n.cssExceeded):o(e).next().removeClass(n.cssExceeded),o(e).next().html(n.counterText+i)}var t={allowed:140,warning:20,css:"counter",counterElement:"span",cssWarning:"warning",cssExceeded:"exceeded",counterText:""};n=o.extend(t,n);this.each(function(){o(this).after("<"+n.counterElement+' class="'+n.css+'">'+n.counterText+"</"+n.counterElement+">"),e(this),o(this).on("keyup",function(){e(this)}),o(this).on("change",function(){e(this)})})}}(jQuery),Dribbble.Bucket=function(e){this.options=e||{},this.type=e.type||"bucket",this.target=e.target,this.container=e.container,this.createOverlay(),this.bindEventListeners()},Dribbble.Bucket.prototype={bindEventListeners:function(){var e="click."+this.type;$(this.options.parentTarget||document.body).off(e).on(e,this.target,this.show.bind(this)),this.overlay.$el.on("keyup",this.navigate.bind(this)).on("click",".create form .cancel",this.hideCreate.bind(this)).on("submit",".create form",this.create.bind(this)).on("click",".add a.create",this.showCreate.bind(this)).on("click","ol li a",this.toggleClicked.bind(this)).on("keyup","#bucket_query",this.search.bind(this)).on("submit","#bucket_search",function(){return!1}).on("mousemove","ol li",this.onMouseMove.bind(this))},create:function(e){var i=$(e.target);return $.ajax({context:this,type:"POST",url:i.attr("action"),data:i.serialize(),beforeSend:function(){$("#bucket-add form input[type=submit]").addClass("processing").attr("disabled","true").attr("value","Processing, please wait\u2026")},statusCode:{201:function(e){this.refresh(e)},200:function(e){this.overlay.find(".create-bucket").html(e)},422:function(e){if(-1<e.getResponseHeader("content-type").indexOf("json")){var t=JSON.parse(e.responseText);i.clank(t.message)}else this.overlay.find(".create-good").html(e.responseText),$("#json-field").length||this.overlay.find(".create-good form").append($("<input>",{id:"json-field",type:"hidden",name:"json",value:!0}))}}},"json"),!1},createOverlay:function(){var e=$("<div />",{id:this.type+"-overlay","class":"overlay"}).appendTo("body").append($("<div />",{id:this.type+"-add","class":"lightbox"}).append($("<a />",{href:"#","class":"close"}).append($("<img />",{src:"/assets/icon-x-lg-e151cb8ae2e919c5d928dbd90c4b073c6bc7e658ee7a9bb456fb0097ea40f26e.png"}))).append($("<div />",{"class":"display"}).append($("<div />",{"class":"processing",text:"Loading\u2026"})))),t=[function(){this.overlay.$el.find(".display").html($("<div />",{"class":"processing",text:"Loading\u2026"})),Dribbble.isMobileSafari()||$("body").removeClass("noscroll")}.bind(this)];if("bucket"==this.type){var i=this,n="/shots/"+this.options.screenshotId+"/buckets_menu";t.push(function(){$(i.container).load(n)})}this.overlay=new Dribbble.Overlay.Simple({$el:e,onHide:t})},hasItems:function(){return 0<this.overlay.find(".add ol li").length},hideCreate:function(){this.hasItems()?this.showAdd():this.overlay.hide()},navigate:function(e){var t=$("#bucket_query");if(t.is(":visible")){switch(e.which){case 13:"project"==this.type&&this.current&&this.current.hasClass("bucketed")?this.overlay.find("#bucket_form").trigger("submit"):this.toggle(this.current);break;case 27:""==$.trim(t.val())?this.overlay.hide():t.val("").trigger("keyup");break;case 38:case 40:var i=38==e.which?this.current.prev():this.current.next();this.select(i,{scrollIntoView:!0})}return!1}},onMouseMove:function(e){if(!this.scrolling){var t=$(e.target).closest("li");this.current&&t.get(0)==this.current.get(0)||this.select(t)}},refresh:function(t){var i=this,e=this.options.listUrl;e||(e=$(this.options.target).attr("href")),t=t||{},this.overlay.find(".display").load(e,function(){if(i.hasItems())if(i.showAdd(),t.id){var e="#"+i.type+"-"+t.id;i.select(e),i.toggle(e)}else i.select("ol.group li:first-child");else i.showCreate();i.overlay.$el.find("ol.group").on("scroll",function(){clearTimeout(i.scrolling),i.scrolling=setTimeout(function(){i.scrolling=!1},250)})})},search:function(e){if(e)switch(e.which){case 13:case 27:case 38:case 40:return void e.preventDefault()}var r=this.overlay.find("#bucket_query").val().toLowerCase();this.overlay.find("ol.group li").each(function(){var e=$(this);-1<e.find("a strong").text().toLowerCase().search(r)?e.show():e.hide()}).sort(function(e,t){var i=$(e).find("a strong").text(),n=$(t).find("a strong").text(),o=i.toLowerCase().search(r),s=n.toLowerCase().search(r);return o==s?n<i?1:-1:s<o?1:-1}).appendTo(this.overlay.find("ol.group")),this.select(this.overlay.find("ol.group li:visible").eq(0))},select:function(e,t){var i=$(e);return 0==i.length||(this.current&&this.current.removeClass("current"),this.current=i,this.current.addClass("current"),t&&t.scrollIntoView&&i.get(0).scrollIntoView(!1)),!1},show:function(){return this.refresh(),this.overlay.show(),Dribbble.isMobileSafari()||$("body").addClass("noscroll"),!1},showAdd:function(){this.overlay.find(".add").show().end().find(".create-bucket, .create-good").hide().end(),Dribbble.isMobile()||$("#bucket_query").trigger("focus")},showCreate:function(){if("good"==this.type)$("#json-field").length||this.overlay.find(".create-good form").append($("<input>",{id:"json-field",type:"hidden",name:"json",value:!0})),this.overlay.find(".add").hide().end().find(".create-good").show().end(),this.overlay.find("#good_title").trigger("focus");else{this.overlay.find(".add").hide().end().find(".create-bucket").show().end();var e=$("#"+this.type+"_name",this.overlay.$el),t=$("#"+this.type+"_description",this.overlay.$el);e.next().hasClass("counter")||e.charCount({allowed:64,warning:10}),t.next().hasClass("counter")||t.charCount({allowed:160}),$("#bucket_name").trigger("focus")}return!1},toggle:function(e){var t=this.overlay.find(e);if("bucket"==this.type){var i=$("#bucket_form").attr("action"),n=function(e){t.replaceWith(e),this.select("#bucket-"+t.modelId())}.bind(this),o=function(e){Notify.error(e.responseText),this.overlay.hide()}.bind(this);t.hasClass("bucketed")?$.ajax(i+"/"+t.modelId(),{type:"DELETE",success:n}):$.post(i,{bucket_id:t.modelId(),screenshot_id:this.screenshotId}).done(n).fail(o),t.toggleClass("bucketed")}else if("good"==this.type)$("ol.goods li.included").removeClass("included"),t.addClass("included"),this.overlay.find(".add form button.form-sub").attr("disabled",!1);else{e=".bucketed:not(.team)";var s=this.overlay.find("#bucket_form");t.hasClass("team")&&(e=".bucketed.team"),t.addClass("bucketed"),t.siblings(e).addClass("unbucketed").removeClass("bucketed"),s.find("input[data-user-id="+t.data("user-id")+"]").remove(),input=$("<input>",{type:"hidden",name:"bucket_id[]","data-user-id":t.data("user-id")}).appendTo(s),input.val(t.modelId()),this.overlay.find(".add form button.form-sub").attr("disabled",!1)}return Dribbble.isMobile()||$("#bucket_query").trigger("focus"),!1},toggleClicked:function(e){return this.toggle($(e.target).closest("li"))}},function($){$.fn.editable=function(e,t){if("disable"!=e)if("enable"!=e){if("destroy"!=e){var c=$.extend({},$.fn.editable.defaults,{target:e},t),d=$.editable.types[c.type].plugin||function(){},h=$.editable.types[c.type].submit||function(){},u=$.editable.types[c.type].buttons||$.editable.types.defaults.buttons,b=$.editable.types[c.type].content||$.editable.types.defaults.content,f=$.editable.types[c.type].element||$.editable.types.defaults.element,p=$.editable.types[c.type].reset||$.editable.types.defaults.reset,m=c.callback||function(){},g=c.onedit||function(){},v=c.onsubmit||function(){},i=c.onreset||function(){},y=c.onerror||p;return c.tooltip&&$(this).attr("title",c.tooltip),c.autowidth="auto"==c.width,c.autoheight="auto"==c.height,this.each(function(){var a=this,n=$(a).width(),l=$(a).height();$(this).data("event.editable",c.event),$.trim($(this).html())||$(this).html(c.placeholder),$(this).on(c.event,function(e){if(!0!==$(this).data("disabled.editable")&&!a.editing&&!1!==g.apply(this,[c,a])){e.preventDefault(),e.stopPropagation(),c.tooltip&&$(a).removeAttr("title"),0==$(a).width()?(c.width=n,c.height=l):("none"!=c.width&&(c.width=c.autowidth?$(a).width():c.width),"none"!=c.height&&(c.height=c.autoheight?$(a).height():c.height)),$(this).html().toLowerCase().replace(/(;|")/g,"")==c.placeholder.toLowerCase().replace(/(;|")/g,"")&&$(this).html(""),a.editing=!0,a.revert=$(a).html(),$(a).html("");var o=$("<form />");c.cssclass&&("inherit"==c.cssclass?o.attr("class",$(a).attr("class")):o.attr("class",c.cssclass)),c.style&&("inherit"==c.style?(o.attr("style",$(a).attr("style")),o.css("display",$(a).css("display"))):o.attr("style",c.style));var t,s=f.apply(o,[c,a]);if(c.loadurl){var r=setTimeout(function(){s.disabled=!0,b.apply(o,[c.loadtext,c,a])},100),i={};null!=c.id&&(i[c.id]=a.id),$.isFunction(c.loaddata)?$.extend(i,c.loaddata.apply(a,[a.revert,c])):$.extend(i,c.loaddata),$.ajax({type:c.loadtype,url:c.loadurl,data:i,async:!1,success:function(e){window.clearTimeout(r),t=e,s.disabled=!1}})}else c.data?(t=c.data,$.isFunction(c.data)&&(t=c.data.apply(a,[a.revert,c]))):t=a.revert;b.apply(o,[t,c,a]),s.attr("name",c.name),u.apply(o,[c,a]),$(a).append(o),d.apply(o,[c,a]),$(":input:visible:enabled:first",o).focus(),c.select&&s.select(),s.keydown(function(e){27==e.keyCode&&(e.preventDefault(),p.apply(o,[c,a]))}),"cancel"==c.onblur?s.blur(function(){r=setTimeout(function(){p.apply(o,[c,a])},500)}):"submit"==c.onblur?s.blur(function(){r=setTimeout(function(){o.submit()},200)}):$.isFunction(c.onblur)?s.blur(function(){c.onblur.apply(a,[s.val(),c])}):s.blur(function(){}),o.submit(function(e){if(r&&clearTimeout(r),e.preventDefault(),!1!==v.apply(o,[c,a])&&!1!==h.apply(o,[c,a]))if($.isFunction(c.target)){var t=c.target.apply(a,[s.val(),c]);$(a).html(t),a.editing=!1,m.apply(a,[a.innerHTML,c]),$.trim($(a).html())||$(a).html(c.placeholder)}else{var i={};i[c.name]=s.val(),null!=c.id&&(i[c.id]=a.id),$.isFunction(c.submitdata)?$.extend(i,c.submitdata.apply(a,[a.revert,c])):$.extend(i,c.submitdata),"PUT"==c.method&&(i._method="put"),$(a).html(c.indicator);var n={type:"POST",data:i,dataType:"html",url:c.target,success:function(e){"html"==n.dataType&&$(a).html(e),a.editing=!1,m.apply(a,[e,c]),$.trim($(a).html())||$(a).html(c.placeholder)},error:function(e){y.apply(o,[c,a,e])}};$.extend(n,c.ajaxoptions),$.ajax(n)}return $(a).attr("title",c.tooltip),!1})}}),this.reset=function(e){this.editing&&!1!==i.apply(e,[c,a])&&($(a).html(a.revert),a.editing=!1,$.trim($(a).html())||$(a).html(c.placeholder),c.tooltip&&$(a).attr("title",c.tooltip))}})}$(this).unbind($(this).data("event.editable")).removeData("disabled.editable").removeData("event.editable")}else $(this).data("disabled.editable",!1);else $(this).data("disabled.editable",!0)},$.editable={types:{defaults:{element:function(){var e=$('<input type="hidden"></input>');return $(this).append(e),e},content:function(e){$(":input:first",this).val(e)},reset:function(e,t){t.reset(this)},buttons:function(t,i){var n=this;if(t.submit){if(t.submit.match(/>$/))var e=$(t.submit).click(function(){"submit"!=e.attr("type")&&n.submit()});else(e=$('<button type="submit" />')).html(t.submit);$(this).append(e)}if(t.cancel){if(t.cancel.match(/>$/))var o=$(t.cancel);else(o=$('<button type="cancel" />')).html(t.cancel);$(this).append(o),$(o).click(function(){if($.isFunction($.editable.types[t.type].reset))var e=$.editable.types[t.type].reset;else e=$.editable.types.defaults.reset;return e.apply(n,[t,i]),!1})}}},text:{element:function(e){var t=$("<input />");return"none"!=e.width&&t.width(e.width),"none"!=e.height&&t.height(e.height),t.attr("autocomplete","off"),$(this).append(t),t}},textarea:{element:function(e){var t=$("<textarea />");return e.rows?t.attr("rows",e.rows):"none"!=e.height&&t.height(e.height),e.cols?t.attr("cols",e.cols):"none"!=e.width&&t.width(e.width),$(this).append(t),t}},select:{element:function(){var e=$("<select />");return $(this).append(e),e},content:function(data,settings,original){if(String==data.constructor)eval("var json = "+data);else var json=data;for(var key in json)if(json.hasOwnProperty(key)&&"selected"!=key){var option=$("<option />").val(key).append(json[key]);$("select",this).append(option)}$("select",this).children().each(function(){$(this).val()!=json.selected&&$(this).text()!=$.trim(original.revert)||$(this).attr("selected","selected")})}}},
addInputType:function(e,t){$.editable.types[e]=t}},$.fn.editable.defaults={name:"value",id:"id",type:"text",width:"auto",height:"auto",event:"click.editable",onblur:"cancel",loadtype:"GET",loadtext:"Loading...",placeholder:"Click to edit",loaddata:{},submitdata:{},ajaxoptions:{}}}(jQuery),Dribbble.Mentions=function(e,t){this.$el=e,this.el=e[0],this.localData=[],this.options=$.extend({},t,this.defaultWidgetOptions()),this.addLocalData(this.options.users||Screenshot.autocompleteJson||[]),this.bindEventListeners()},Dribbble.Mentions.followedUsers=[],Dribbble.Mentions.prototype={minChars:2,maxLocalMatches:10,cache:new Dribbble.AutocompleteCache,bindEventListeners:function(){Dribbble.Autocomplete(this.$el,this.options,function(e){this.widget=e}.bind(this)),0<Dribbble.Mentions.followedUsers.length?this.addFollowedUsersToLocalData():$.get(this.options.url,this.addFollowedUsersToLocalData.bind(this))},uniqueConcat:function(e,t){var i=[];$.each(e,function(e,t){i.push(t.user_id)});var n=e;return $.each(t,function(e,t){-1==i.indexOf(t.user_id)&&n.push(t)}),n},addLocalData:function(e){this.localData=this.uniqueConcat(this.localData,e)},addFollowedUsersToLocalData:function(e){e&&(Dribbble.Mentions.followedUsers=e),this.addLocalData(Dribbble.Mentions.followedUsers)},extractTerm:function(){var e=this.$el.prop("selectionEnd"),t=this.$el.val().substring(0,e),i=t.lastIndexOf("@");return-1==i?null:t.substring(i+1).toLowerCase()},finder:function(o,t){var s=[];$.each(this.localData,function(e,t){var i=0==t.login.toLowerCase().indexOf(o),n=t.name&&0==t.name.toLowerCase().indexOf(o);(i||n)&&(s.push(t),s.length,this.maxLocalMatches)}),$.get("/mention_autocomplete",{q:o},function(e){t(this.uniqueConcat(s,e))}.bind(this))},cachedFinder:function(e,t){this.cache.lookup(e,t,this.finder.bind(this))},insertMention:function(e){var t=this.$el.prop("selectionEnd"),i=(this.extractTerm(),this.$el.val()),n=(s=i.slice(0,t)).lastIndexOf("@"),o=i.slice(t),s=s.slice(0,n+1),r=0==o.length?" ":"";this.$el.val(s+e+r+o),this.$el.prop("selectionEnd",(s+e+r).length+1)},defaultWidgetOptions:function(){return bindAll({autoFocus:!0,source:function(e,t){var i=this.extractTerm();this.cachedFinder(i,t)},search:function(){var e=this.extractTerm();if(null==e||""==e||e.length<this.minChars||this.cache.isDeadEnd(e))return this.widget.close(),!1},focus:function(e){e.preventDefault()},select:function(e,t){this.insertMention(t.item.name),this.$el.after($('<input type="hidden" name="mentioned_user_id_list[]"/>').val(t.item.user_id)),this.widget.disable(),e.preventDefault()},keypress:function(e){"@"===String.fromCharCode(e.which)&&this.widget.enable()},renderer:function(e,t){var i=t.name||t.login,n='<img src="'+t.avatar_url+'" class="photo fn"> <strong>'+i+"</strong> ("+t.login+")";return $("<li></li>").data("item.autocomplete",t).append($("<a></a>").html(n)).appendTo(e)}},this)}},Dribbble.Comments=function(e,t,i){this.onLoad=t,this.bindEventListeners(i),this.load(e)},Dribbble.Comments.prototype={bindEventListeners:function(e){this.initNavigationLinks(),this.makeFansViewable(),e&&e.apply(this)},load:function(e,o){$.get(e,function(e){var t,i,n=$("#comments-section");n.html(e),o?(t=$(".shot-overlay:visible")[0],i=n[0].getBoundingClientRect().top+$(t).scrollTop()):location.hash&&0===location.hash.indexOf("#comment-")&&(i=$(location.hash).offset().top),i&&$(t||$("html, body")).animate({scrollTop:i},500),$(".comment.current-user .comment-body").each(function(e,t){this.makeCommentEditable(t)}.bind(this)),this.onLoad&&this.onLoad()}.bind(this))},initNavigationLinks:function(){$("#comments-section").on("click.comment-nav",".comments-sort a, .comment-pagination a",function(e){var t=$(e.currentTarget).attr("href").split("?")[1],i=this.url(t);return this.load(i,this.initComments,!0),!1}.bind(this))},makeFansViewable:function(){$("#comments-section").on("click.view-comment-fans",".comment .likes-list",function(){var t=$(this);if(t.data("loading"))return!1;var i=t.closest(".comment"),e=i.find(".comment-likes");return e.length?e.remove():(t.data("loading",!0),$.get(this.href,function(e){t.removeData("loading"),i.append(e)})),!1})},url:function(e){var t="/shots/"+$("[data-screenshot_id]").data("screenshot_id")+"/comments";return e&&(t=t+"?"+e),t},makeCommentsDeleteable:function(e){var t=e?".comment":".comment.current-user";$(".comments").on("click.delete-comment",t+" a.delete",function(){if(!confirm("You are about to delete this comment. Continue?"))return!1;var i=$(this);return $.post(this.href,{_method:"delete"},function(e){var t=$("#comments-section .count");0==e.count&&t.hide(),t.html(e.header),i.closest(".comment").remove()},"json"),!1})},makeCommentsEditable:function(){$(".comments").on("click.edit-comments",".comment.current-user a.edit",function(e){var t=$(e.currentTarget),i=t.closest(".comment").find(".comment-body").trigger("programmaticEvent.editable");return this.Mentions.enable(t.data("autocomplete"),i.find("textarea")),!1}.bind(this))},makeCommentEditable:function(e){var t=$(e),i=(t.closest(".comment").modelId(),t.closest(".comment").find("a.edit").attr("href")),n=t.closest(".comment").find("a.delete").attr("href");t.editable(n,{loadurl:i,type:"textarea",width:"none",height:"none",DEheight:"none",name:"text",method:"PUT",cssclass:"comment group edit-comment",id:null,submit:"Save",cancel:"Cancel",indicator:'<span class="processing">Saving\u2026</span>',event:"programmaticEvent.editable",onblur:"ignore",submitdata:function(){return{"mentioned_user_id_list[]":$.map($(this).find('input[type=hidden][name="mentioned_user_id_list[]"]'),function(e){return e.value})}}})},Mentions:{enable:function(e,t){new Dribbble.Mentions(t,{url:e})}},enableAjaxSubmission:function(){$("#comment_text").on("keydown",function(e){if(e.metaKey&&13==e.keyCode)return $("#add-comment").trigger("submit"),!1}),$("#add-comment").ajaxForm({dataType:"json",beforeSend:function(){if($("#add-comment").removeClass("error"),$("#add-comment .error").remove(),""==$("#add-comment textarea").val())return!1;$("#post-comment-btn").addClass("processing").attr("disabled","true").attr("value","Processing, please wait\u2026")},success:function(e){e.redirect_to?window.location=e.redirect_to:($("#comments").append(e.comment),$("#comments-section .count").html(e.header).show(),$("#add-comment textarea").val(""),$("#post-comment-btn").prop("disabled",!1).attr("value","Post comment"),$("#post-comment-btn").removeClass("processing"),this.makeCommentEditable("#comment-"+e.id+" .comment-body"),$('#add-comment input[name="mentioned_user_id_list[]"]').remove())}.bind(this),error:function(e){var t=$.parseJSON(e.responseText),i=(t.text||t.base)[0];$("#add-comment").addClass("error"),$("#add-comment textarea").after($("<p>",{text:i,"class":"error"})),$("#post-comment-btn").prop("disabled",!1).removeClass("processing").attr("value","Post comment")}})}},Dribbble.Comments.ReplyLinks={addAll:function(n){$("#comments li").each(function(e,t){var i=parseInt($(t).data("user-id"),10);n!=i&&this.add($(t))}.bind(this))},add:function(e){e.find(".reply").length||(e.find(".posted").after(' <span class="sep">|</span> <a href="#" class="reply">Reply</a>'),e.find(".reply").on("click",function(e){var t=$(this).parents("li"),i=$("#add-comment textarea"),n=i.prop("selectionEnd"),o=i.val(),s=t.hasClass("rebound")?t.find('.comment-body a[rel="contact"]'):t.find('a[rel="contact"]'),r="@"+$.trim(s.text())+" ";o=o.substring(0,n)+r+o.substring(n);return n+=r.length,e.shiftKey||i.trigger("focus"),i.val(o).prop("selectionEnd",n).prop("selectionStart",n).after($('<input type="hidden" name="mentioned_user_id_list[]"/>').val(t.data("user-id"))),!1}))}},Dribbble.Attachments={initialize:function(){this.findElements(),this.bindEventListeners(),this.swipeEnabled=!0,Dribbble.Hotkeys.map("attachments",{ESCAPE:Dribbble.Attachments.Keys.escape,RIGHT:Dribbble.Attachments.Keys.right,LEFT:Dribbble.Attachments.Keys.left},Dribbble.Attachments.overlayVisible.bind(this))},bindEventListeners:function(){var t=this,e=[".detail-shot a",".attachments ul.thumbs li a","#attachments ul li a"].join(",");$(document.body).on("click",e,function(e){if(!e.shiftKey&&!e.ctrlKey&&!e.metaKey)return t.openOverlay($(this)),!1}),$(document.body).on("click",".close-attachments a",function(){return t.closeOverlay(),!1}),$(document.body).on("click","#viewer-img img",function(){return $(this).toggleClass("zoomed"),$("#viewer").toggleClass("zoomed"),$("#secondary").toggleClass("zoomed"),t.toggleSwipeListener(),!1})},showOverlay:function(e){var t=this;this.overlay.length&&$.ajax(e,{dataType:"html",cache:!1,success:function(e){t.overlay.html(e),Dribbble.isMobile()?$(".shot-overlay").is(":visible")?($(".shot-overlay").hide(),t.inShotOverlay=!0):$("#header, #wrap, #footer").hide():$("body, .shot-overlay").addClass("attachment-noscroll"),t.overlay.show().trigger("focus"),t.bindSwipeListener()}})},hideOverlay:function(){Dribbble.isMobile()?this.inShotOverlay?$(".shot-overlay").show():$("#header, #wrap, #footer").show():$("body, .shot-overlay").removeClass("attachment-noscroll"),this.overlay.empty().hide()},closeOverlay:function(){Dribbble.Router.go(-this.stepsToShotPage())},openOverlay:function(e){var t=e.attr("href"),i=e.data("title");t&&Dribbble.Router.pushState({"steps-from-shot":this.stepsToShotPage()+1},i,t)},findElements:function(){this.overlay=$(".attachment-overlay")},overlayVisible:function(){return this.overlay&&this.overlay.is(":visible")},stepsToShotPage:function(){return History.getState().data["steps-from-shot"]||0},navigate:function(e){var t=$("#attachments"),i=t.find("li.active"),n=e?i.prev("li"):i.next("li");if(!n.length){var o=e?-1:0;n=t.find("li").eq(o)}var s=n.find("a");this.openOverlay(s)},toggleSwipeListener:function(){Dribbble.isMobile()&&($("#viewer-img img").swipe(this.swipeEnabled?"disable":"enable"),this.swipeEnabled=!this.swipeEnabled)},bindSwipeListener:function(){Dribbble.isMobile()&&(this.swipeEnabled=!0,$("#viewer-img img").swipe({fingers:1,threshold:200,swipeLeft:Dribbble.Attachments.Keys.right,swipeRight:Dribbble.Attachments.Keys.left}))},Keys:{escape:function(){Dribbble.Attachments.closeOverlay()},left:function(){Dribbble.Attachments.navigate(!0)},right:function(){Dribbble.Attachments.navigate(!1)}}},$(".attachment-overlay").length&&Dribbble.isHistorySupported()&&Dribbble.Attachments.initialize();var Dribbble=Dribbble||{};Dribbble.VideoPlayer=function(){var e=function(e){this.video=document.querySelector(e),this.container=document.querySelector(".video-container"),this.controls=null,this.mute=null,this.video&&this.container&&(this.controls=this.container.querySelector(".video-controls"),this.mute=this.controls.querySelector(".mute-controls"),this.mute.className="mute-controls mute-mute",this.hasAudio="true"!=this.video.dataset.silent,this.video.muted=!0,this.hasAudio&&this.mute.addEventListener("click",t.togglemute.bind(this)))},t={togglemute:function(){this.mute.className=this.video.muted?"mute-controls mute-unmute":"mute-controls mute-mute",this.video.muted=!this.video.muted}};return e}(),function(e){var t=!1;if("function"==typeof define&&define.amd&&(define(e),t=!0),"object"==typeof exports&&(module.exports=e(),t=!0),!t){var i=window.Cookies,n=window.Cookies=e();n.noConflict=function(){return window.Cookies=i,n}}}(function(){function m(){for(var e=0,t={};e<arguments.length;e++){var i=arguments[e];for(var n in i)t[n]=i[n]}return t}function e(f){function p(e,t,i){var n;if("undefined"!=typeof document){if(1<arguments.length){if("number"==typeof(i=m({path:"/"},p.defaults,i)).expires){var o=new Date;o.setMilliseconds(o.getMilliseconds()+864e5*i.expires),i.expires=o}i.expires=i.expires?i.expires.toUTCString():"";try{n=JSON.stringify(t),/^[\{\[]/.test(n)&&(t=n)}catch(b){}t=f.write?f.write(t,e):encodeURIComponent(String(t)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=(e=(e=encodeURIComponent(String(e))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var s="";for(var r in i)i[r]&&(s+="; "+r,!0!==i[r]&&(s+="="+i[r]));return document.cookie=e+"="+t+s}e||(n={});for(var a=document.cookie?document.cookie.split("; "):[],l=/(%[0-9A-Z]{2})+/g,c=0;c<a.length;c++){var d=a[c].split("="),h=d.slice(1).join("=");'"'===h.charAt(0)&&(h=h.slice(1,-1));try{var u=d[0].replace(l,decodeURIComponent);if(h=f.read?f.read(h,u):f(h,u)||h.replace(l,decodeURIComponent),this.json)try{h=JSON.parse(h)}catch(b){}if(e===u){n=h;break}e||(n[u]=h)}catch(b){}}return n}}return(p.set=p).get=function(e){return p.call(p,e)},p.getJSON=function(){return p.apply({json:!0},[].slice.call(arguments))},p.defaults={},p.remove=function(e,t){p(e,"",m(t,{expires:-1}))},p.withConverter=e,p}return e(function(){})}),Dribbble.ShotSizes={currentSize:function(){return $("body").hasClass("grid-large")?"large":"small"},viewingLargeShots:function(){return"large"==this.currentSize()},setupWidget:function(){var e=$("ul.large-small");Dribbble.isMobile()&&e.find("[rel=tipsy]").attr("original-title","");var t=function(e,t,i){Cookies.set("shot_size_preference",t,{expires:365}),Cookies.set("shot_meta_preference",i,{expires:365});var n=$(e),o=this.currentSize()!=t;n.siblings().removeClass("active"),n.addClass("active"),$("body").removeClass("grid-without-meta grid-with-meta grid-"+this.currentSize()).addClass("grid-"+i+"-meta grid-"+t),o&&(Dribbble.Shots.clear(),Dribbble.Screenshots&&Dribbble.Screenshots.refreshList())}.bind(this);e.on("click","li.small-with-meta",function(){return t(this,"small","with"),!1}),e.on("click","li.small-without-meta",function(){return t(this,"small","without"),!1}),e.on("click","li.large-with-meta",function(){return t(this,"large","with"),!1}),e.on("click","li.large-without-meta",function(){return t(this,"large","without"),!1})}},Dribbble.ShotSizes.setupWidget(),Dribbble.Viewport={height:function(){return window.innerHeight||document.documentElement.clientHeight},isVerticallyVisible:function(e,t){t=t||0;var i=e.getBoundingClientRect();return i.top>-1*t&&i.bottom<this.height()+t}},Dribbble.LargeShotViewRecorder={start:function(){var e;Dribbble.ShotSizes.viewingLargeShots()&&($(window).off("scroll.largeShotViewRecorder"),$(window).on("scroll.largeShotViewRecorder",function(){clearTimeout(e),Dribbble.ShotSizes.viewingLargeShots()&&(e=setTimeout(function(){this.considerShotsViewed()}.bind(this),500))}.bind(this)),setTimeout(this.considerShotsViewed.bind(this),1e3))},getScreenshotsInViewPort:function(){return $("li.group[id^=screenshot-]").filter(function(){return Dribbble.Viewport.isVerticallyVisible(this,30)})},considerShotsViewed:function(){this.getScreenshotsInViewPort().each(function(e,t){var i=parseInt(t.id.split("-")[1],10);Dribbble.Shots.logView(i)})}},Dribbble.LargeShotViewRecorder.start();