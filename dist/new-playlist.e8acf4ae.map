{"version":3,"sources":["js/new-playlist.js"],"names":["view","el","template","init","$el","$","render","newSongList","find","empty","map","data","li","cover","name","artist","append","html","model","getNewSong","axios","get","then","response","songItem","result","index","id","song","album","picUrl","artists","splice","length","controller","bindEvents","on","e","currentTarget","console","log","obj","url","window","eventHub","emit"],"mappings":"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","file":"new-playlist.e8acf4ae.map","sourceRoot":"../src","sourcesContent":["{\n    let view ={\n        el: '#newPlayList',\n        template: `\n        <h5>\n            <span>最近音乐</span>\n            <svg class=\"icon arrow\" aria-hidden=\"true\" id=\"controlSongList\">\n              <use xlink:href=\"#icon-rightarrow\"></use>\n            </svg>\n        </h5>\n        <ul>\n        </ul> \n        `,\n        init() {\n            this.$el = $(this.el)\n        },\n        render(newSongList) {\n            if (newSongList) {\n                this.$el.find('ul').empty()\n                newSongList.map((data) => {\n                    let li = `\n                    <li>\n                        <img src=${data.cover || ''} width=113px height=113px>\n                        <div>\n                            <span class=\"hideOverflow\">${data.name}</span>\n                            <span class=\"hideOverflow\">${data.artist}</span>\n                        </div>\n                    </li>\n                    `\n                    this.$el.find('ul').append(li)\n                })\n            } else {\n                this.$el.html(this.template)\n            }\n        }\n    }\n\n    let model = {\n        data: {\n            newSongList: []\n        },\n        getNewSong() {\n            return axios.get('/personalized/newsong?limit=8').then((response) => {\n                let songItem = response.data.result.map((data, index) => {\n                    return {\n                        id: data.id,\n                        name: data.name,\n                        cover: data.song.album.picUrl,\n                        artist: data.song.artists[0].name\n                    }\n                })\n                songItem.splice(songItem.length-1)\n                this.data.newSongList = songItem\n            })\n        }\n    }\n\n    let controller = {\n        init(view, model) {\n            this.view = view \n            this.model = model \n            this.view.init()\n            this.view.render()\n            this.model.getNewSong().then(() => {\n                this.view.render(this.model.data.newSongList)\n            })\n            this.bindEvents()\n        },\n        bindEvents() {\n           this.view.$el.on('click', 'ul > li', (e) => {\n                let index = $(e.currentTarget).index()\n                console.log(this.model.data.newSongList[index])\n                let obj = this.model.data.newSongList[index] \n                axios.get('/song/url?id=' + obj.id).then((response) => {\n                    console.log(response)\n                    obj.url = response.data.data[0].url\n                    window.eventHub.emit('playSong', obj)\n                })\n           }) \n        }\n    }\n\n    controller.init(view, model) \n}"]}